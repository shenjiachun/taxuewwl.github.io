
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>springboot整合redis小结 | 朝·闻·道</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="SnoWalker">
    

    <meta name="keywords" content="spring-boot">
    <meta name="description" content="之前在开发中需要用到redis的场景都习惯用自行封装的jedis工具类进行缓存相关的调用，总感觉有些奇怪，对外部的依赖较多，而且不灵活。
既然用了springboot，官方当然为我们考虑到redis的使用，本文就总结一下springboot应用中使用redis缓存。
补充-SpringBoot2.x整合Redis之前的文章介绍的1.x的整合方式在SpringBoot2.x中不能直接引用，因此对2.">
<meta property="og:type" content="article">
<meta property="og:title" content="springboot整合redis小结">
<meta property="og:url" content="http://wuwenliang.net/2018/07/23/springboot整合redis小结/index.html">
<meta property="og:site_name" content="朝·闻·道">
<meta property="og:description" content="之前在开发中需要用到redis的场景都习惯用自行封装的jedis工具类进行缓存相关的调用，总感觉有些奇怪，对外部的依赖较多，而且不灵活。
既然用了springboot，官方当然为我们考虑到redis的使用，本文就总结一下springboot应用中使用redis缓存。
补充-SpringBoot2.x整合Redis之前的文章介绍的1.x的整合方式在SpringBoot2.x中不能直接引用，因此对2.">
<meta property="og:updated_time" content="2019-03-26T03:42:58.087Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="springboot整合redis小结">
<meta name="twitter:description" content="之前在开发中需要用到redis的场景都习惯用自行封装的jedis工具类进行缓存相关的调用，总感觉有些奇怪，对外部的依赖较多，而且不灵活。
既然用了springboot，官方当然为我们考虑到redis的使用，本文就总结一下springboot应用中使用redis缓存。
补充-SpringBoot2.x整合Redis之前的文章介绍的1.x的整合方式在SpringBoot2.x中不能直接引用，因此对2.">

    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="朝·闻·道" title="朝·闻·道"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="朝·闻·道">朝·闻·道</a></h1>
				<h2 class="blog-motto">SnoWalker&#39;s Blog</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="/old/index.html">旧版</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:wuwenliang.net">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/07/23/springboot整合redis小结/" title="springboot整合redis小结" itemprop="url">springboot整合redis小结</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="SnoWalker" target="_blank" itemprop="author">SnoWalker</a>
		
  <p class="article-time">
    <time datetime="2018-07-23T15:53:43.000Z" itemprop="datePublished"> 发表于 2018-07-23</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#补充-SpringBoot2-x整合Redis"><span class="toc-number">1.</span> <span class="toc-text">补充-SpringBoot2.x整合Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#引入maven依赖"><span class="toc-number">1.1.</span> <span class="toc-text">引入maven依赖</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#配置application-properties"><span class="toc-number">1.2.</span> <span class="toc-text">配置application.properties</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#编写测试用例"><span class="toc-number">1.3.</span> <span class="toc-text">编写测试用例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SpringBoot1-x整合方式"><span class="toc-number">2.</span> <span class="toc-text">SpringBoot1.x整合方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#maven依赖"><span class="toc-number">3.</span> <span class="toc-text">maven依赖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#配置文件"><span class="toc-number">4.</span> <span class="toc-text">配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#封装RedisUtil工具类"><span class="toc-number">5.</span> <span class="toc-text">封装RedisUtil工具类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#单机模式整合redis"><span class="toc-number">6.</span> <span class="toc-text">单机模式整合redis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#集群模式"><span class="toc-number">7.</span> <span class="toc-text">集群模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#哨兵模式整合"><span class="toc-number">8.</span> <span class="toc-text">哨兵模式整合</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用RedisUtil"><span class="toc-number">9.</span> <span class="toc-text">使用RedisUtil</span></a></li></ol>
		
		</div>
		
		<p>之前在开发中需要用到redis的场景都习惯用自行封装的jedis工具类进行缓存相关的调用，总感觉有些奇怪，对外部的依赖较多，而且不灵活。</p>
<p>既然用了springboot，官方当然为我们考虑到redis的使用，本文就总结一下springboot应用中使用redis缓存。</p>
<h2 id="补充-SpringBoot2-x整合Redis"><a href="#补充-SpringBoot2-x整合Redis" class="headerlink" title="补充-SpringBoot2.x整合Redis"></a>补充-SpringBoot2.x整合Redis</h2><p>之前的文章介绍的1.x的整合方式在SpringBoot2.x中不能直接引用，因此对2.x的版本下整合Redis的方式做一下补充讲解。</p>
<h3 id="引入maven依赖"><a href="#引入maven依赖" class="headerlink" title="引入maven依赖"></a>引入maven依赖</h3><p>首先看下parent依赖，确认版本为SpringBoot2.1.2Release</p>
<pre><code>&lt;parent&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
    &lt;version&gt;2.1.2.RELEASE&lt;/version&gt;
&lt;/parent&gt;
</code></pre><p>引入spring-boot-starter-data-redis依赖</p>
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre><p>默认版本和parent版本保持一致，这里为2.1.2.RELEASE</p>
<a id="more"></a>
<h3 id="配置application-properties"><a href="#配置application-properties" class="headerlink" title="配置application.properties"></a>配置application.properties</h3><p>编辑application.properties，添加对redis的支持</p>
<p>首先看下单点方式的配置</p>
<pre><code>########################################################################
#
#     redis配置
#
#########################################################################
#Matser的ip地址
spring.redis.host=172.30.66.22
#端口号
spring.redis.port=6379
#客户端超时时间单位是毫秒 默认是2000
spring.redis.timeout=10000
#如果有密码
spring.redis.password=123456
spring.redis.jedis.pool.max-active=8
#最大建立连接等待时间。如果超过此时间将接到异常。设为-1表示无限制。
spring.redis.jedis.pool.max-wait=-1
#最大空闲数
#连接池的最大数据库连接数。设为0表示无限制,如果是jedis 2.4以后用redis.maxTotal
spring.redis.jedis.pool.max-idle=8
spring.redis.jedis.pool.min-idle=0
#使用哪一个数据库
spring.redis.database=15
</code></pre><p>集群方式配置如下</p>
<pre><code>#redis集群配置
spring.redis.cluster.nodes=192.168.177.128:7001,192.168.177.128:7002,192.168.177.128:7003,192.168.177.128:7004,192.168.177.128:7005,192.168.177.128:7006
spring.redis.cluster.max-redirects=3
</code></pre><p>其中：</p>
<p><strong>spring.redis.cluster.max-redirects</strong> 表示<br>最大的要重定向的次数（由于集群中数据存储在多个节点所以在访问数据时需要通过节点进行转发）</p>
<p><strong>spring.redis.cluster.nodes</strong> 表示 代表redis多个节点的ip与端口号，多个节点需要使用“,”(英文半角逗号)隔开</p>
<p>即在cluster.nodes中配置每一个节点的ip:port,通过逗号进行分割</p>
<p>对于哨兵方式配置如下</p>
<pre><code>#哨兵模式
spring.redis.sentinel.master=
spring.redis.sentinel.nodes=
</code></pre><h3 id="编写测试用例"><a href="#编写测试用例" class="headerlink" title="编写测试用例"></a>编写测试用例</h3><p>对于使用方式，SpringBoot2.x与1.x没有区别，只需要在需要操作Redis的SpringBean中注入RedisTemplate/StringRedisTemplate即可进行操作，代码样例如下：</p>
<pre><code>@Component
public class RedisCommandLineRunner implements CommandLineRunner {

    @Autowired
    StringRedisTemplate redisTemplate;

    @Override
    public void run(String... args) throws Exception {
        // TODO 完成key=name value=springboot的 set get del 操作，set操作设置过期时间为3600s
        redisTemplate.opsForValue().set(&quot;key&quot;, &quot;value&quot;);
    }
}
</code></pre><h2 id="SpringBoot1-x整合方式"><a href="#SpringBoot1-x整合方式" class="headerlink" title="SpringBoot1.x整合方式"></a>SpringBoot1.x整合方式</h2><h2 id="maven依赖"><a href="#maven依赖" class="headerlink" title="maven依赖"></a>maven依赖</h2><p>在pom中添加如下依赖，版本默认为parent的版本号。</p>
<pre><code>&lt;!-- 整合redis --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre><h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><p>为了和其他配置区分，我们创建一个独立的redis配置文件，redis.properties</p>
<pre><code>#Matser的ip地址  
redis.hostName=192.168.177.128
#端口号  
redis.port=6382
#如果有密码  
redis.password=
#客户端超时时间单位是毫秒 默认是2000 
redis.timeout=10000  

#最大空闲数  
redis.maxIdle=300  
#连接池的最大数据库连接数。设为0表示无限制,如果是jedis 2.4以后用redis.maxTotal  
#redis.maxActive=600  
#控制一个pool可分配多少个jedis实例,用来替换上面的redis.maxActive,如果是jedis 2.4以后用该属性  
redis.maxTotal=1000  
#最大建立连接等待时间。如果超过此时间将接到异常。设为-1表示无限制。  
redis.maxWaitMillis=1000  
#连接的最小空闲时间 默认1800000毫秒(30分钟)  
redis.minEvictableIdleTimeMillis=300000  
#每次释放连接的最大数目,默认3  
redis.numTestsPerEvictionRun=1024  
#逐出扫描的时间间隔(毫秒) 如果为负数,则不运行逐出线程, 默认-1  
redis.timeBetweenEvictionRunsMillis=30000  
#是否在从池中取出连接前进行检验,如果检验失败,则从池中去除连接并尝试取出另一个  
redis.testOnBorrow=true  
#在空闲时检查有效性, 默认false  
redis.testWhileIdle=true  

#redis集群配置      
spring.redis.cluster.nodes=192.168.177.128:7001,192.168.177.128:7002,192.168.177.128:7003,192.168.177.128:7004,192.168.177.128:7005,192.168.177.128:7006
spring.redis.cluster.max-redirects=3

#哨兵模式
#redis.sentinel.host1=192.168.177.128
#redis.sentinel.port1=26379

#redis.sentinel.host2=172.20.1.231  
#redis.sentinel.port2=26379
</code></pre><h2 id="封装RedisUtil工具类"><a href="#封装RedisUtil工具类" class="headerlink" title="封装RedisUtil工具类"></a>封装RedisUtil工具类</h2><p>这个工具类就是我们调用的核心，也就是我们自己封装的jedis工具类，但是会通过spring的依赖注入放到容器中，在需要使用的地方直接Autowired就可以。</p>
<pre><code>import java.util.List;
import java.util.Map;
import java.util.Set;
import java.util.concurrent.TimeUnit;

import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.util.CollectionUtils;

public class RedisUtil {

private RedisTemplate&lt;String, Object&gt; redisTemplate;  

    public void setRedisTemplate(RedisTemplate&lt;String, Object&gt; redisTemplate) {  
        this.redisTemplate = redisTemplate;  
    }  
    //=============================common============================  
    /** 
    * 指定缓存失效时间 
    * @param key 键 
    * @param time 时间(秒) 
    * @return 
    */  
    public boolean expire(String key,long time){  
        try {  
            if(time&gt;0){  
                redisTemplate.expire(key, time, TimeUnit.SECONDS);  
            }  
            return true;  
        } catch (Exception e) {  
            e.printStackTrace();  
            return false;  
        }  
    }  

    /** 
    * 根据key 获取过期时间 
    * @param key 键 不能为null 
    * @return 时间(秒) 返回0代表为永久有效 
    */  
    public long getExpire(String key){  
        return redisTemplate.getExpire(key,TimeUnit.SECONDS);  
    }  

    /** 
    * 判断key是否存在 
    * @param key 键 
    * @return true 存在 false不存在 
    */  
    public boolean hasKey(String key){  
        try {  
            return redisTemplate.hasKey(key);  
        } catch (Exception e) {  
            e.printStackTrace();  
            return false;  
        }  
    }  

    /** 
    * 删除缓存 
    * @param key 可以传一个值 或多个 
    */  
    @SuppressWarnings(&quot;unchecked&quot;)  
    public void del(String ... key){  
        if(key!=null&amp;&amp;key.length&gt;0){  
            if(key.length==1){  
                redisTemplate.delete(key[0]);  
            }else{  
                redisTemplate.delete(CollectionUtils.arrayToList(key));  
            }  
        }  
    }  

    //============================String=============================  
    /** 
    * 普通缓存获取 
    * @param key 键 
    * @return 值 
    */  
    public Object get(String key){  
        return key==null?null:redisTemplate.opsForValue().get(key);  
    }  

    /** 
    * 普通缓存放入 
    * @param key 键 
    * @param value 值 
    * @return true成功 false失败 
    */  
    public boolean set(String key,Object value) {  
        try {  
            redisTemplate.opsForValue().set(key, value);  
            return true;  
        } catch (Exception e) {  
            e.printStackTrace();  
            return false;  
        }  

    }  

    /** 
    * 普通缓存放入并设置时间 
    * @param key 键 
    * @param value 值 
    * @param time 时间(秒) time要大于0 如果time小于等于0 将设置无限期 
    * @return true成功 false 失败 
    */  
    public boolean set(String key,Object value,long time){  
        try {  
            if(time&gt;0){  
                redisTemplate.opsForValue().set(key, value, time, TimeUnit.SECONDS);  
            }else{  
                set(key, value);  
            }  
            return true;  
        } catch (Exception e) {  
            e.printStackTrace();  
            return false;  
        }  
    }  

    /** 
    * 递增 
    * @param key 键 
    * @param by 要增加几(大于0) 
    * @return 
    */  
    public long incr(String key, long delta){    
        if(delta&lt;0){  
            throw new RuntimeException(&quot;递增因子必须大于0&quot;);  
        }  
        return redisTemplate.opsForValue().increment(key, delta);  
    }  

    /** 
    * 递减 
    * @param key 键 
    * @param by 要减少几(小于0) 
    * @return 
    */  
    public long decr(String key, long delta){    
        if(delta&lt;0){  
            throw new RuntimeException(&quot;递减因子必须大于0&quot;);  
        }  
        return redisTemplate.opsForValue().increment(key, -delta);    
    }    

    //================================Map=================================  
    /** 
    * HashGet 
    * @param key 键 不能为null 
    * @param item 项 不能为null 
    * @return 值 
    */  
    public Object hget(String key,String item){  
        return redisTemplate.opsForHash().get(key, item);  
    }  

    /** 
    * 获取hashKey对应的所有键值 
    * @param key 键 
    * @return 对应的多个键值 
    */  
    public Map&lt;Object,Object&gt; hmget(String key){  
        return redisTemplate.opsForHash().entries(key);  
    }  

    /** 
    * HashSet 
    * @param key 键 
    * @param map 对应多个键值 
    * @return true 成功 false 失败 
    */  
    public boolean hmset(String key, Map&lt;String,Object&gt; map){    
        try {  
            redisTemplate.opsForHash().putAll(key, map);  
            return true;  
        } catch (Exception e) {  
            e.printStackTrace();  
            return false;  
        }  
    }  

    /** 
    * HashSet 并设置时间 
    * @param key 键 
    * @param map 对应多个键值 
    * @param time 时间(秒) 
    * @return true成功 false失败 
    */  
    public boolean hmset(String key, Map&lt;String,Object&gt; map, long time){    
        try {  
            redisTemplate.opsForHash().putAll(key, map);  
            if(time&gt;0){  
                expire(key, time);  
            }  
            return true;  
        } catch (Exception e) {  
            e.printStackTrace();  
            return false;  
        }  
    }  

    /** 
    * 向一张hash表中放入数据,如果不存在将创建 
    * @param key 键 
    * @param item 项 
    * @param value 值 
    * @return true 成功 false失败 
    */  
    public boolean hset(String key,String item,Object value) {  
        try {  
            redisTemplate.opsForHash().put(key, item, value);  
            return true;  
        } catch (Exception e) {  
            e.printStackTrace();  
            return false;  
        }  
    }  

    /** 
    * 向一张hash表中放入数据,如果不存在将创建 
    * @param key 键 
    * @param item 项 
    * @param value 值 
    * @param time 时间(秒)  注意:如果已存在的hash表有时间,这里将会替换原有的时间 
    * @return true 成功 false失败 
    */  
    public boolean hset(String key,String item,Object value,long time) {  
        try {  
            redisTemplate.opsForHash().put(key, item, value);  
            if(time&gt;0){  
                expire(key, time);  
            }  
            return true;  
        } catch (Exception e) {  
            e.printStackTrace();  
            return false;  
        }  
    }  

    /** 
    * 删除hash表中的值 
    * @param key 键 不能为null 
    * @param item 项 可以使多个 不能为null 
    */  
    public void hdel(String key, Object... item){    
        redisTemplate.opsForHash().delete(key,item);  
    }   

    /** 
    * 判断hash表中是否有该项的值 
    * @param key 键 不能为null 
    * @param item 项 不能为null 
    * @return true 存在 false不存在 
    */  
    public boolean hHasKey(String key, String item){  
        return redisTemplate.opsForHash().hasKey(key, item);  
    }   

    /** 
    * hash递增 如果不存在,就会创建一个 并把新增后的值返回 
    * @param key 键 
    * @param item 项 
    * @param by 要增加几(大于0) 
    * @return 
    */  
    public double hincr(String key, String item,double by){    
        return redisTemplate.opsForHash().increment(key, item, by);  
    }  

    /** 
    * hash递减 
    * @param key 键 
    * @param item 项 
    * @param by 要减少记(小于0) 
    * @return 
    */  
    public double hdecr(String key, String item,double by){    
        return redisTemplate.opsForHash().increment(key, item,-by);    
    }    

    //============================set=============================  
    /** 
    * 根据key获取Set中的所有值 
    * @param key 键 
    * @return 
    */  
    public Set&lt;Object&gt; sGet(String key){  
        try {  
            return redisTemplate.opsForSet().members(key);  
        } catch (Exception e) {  
            e.printStackTrace();  
            return null;  
        }  
    }  

    /** 
    * 根据value从一个set中查询,是否存在 
    * @param key 键 
    * @param value 值 
    * @return true 存在 false不存在 
    */  
    public boolean sHasKey(String key,Object value){  
        try {  
            return redisTemplate.opsForSet().isMember(key, value);  
        } catch (Exception e) {  
            e.printStackTrace();  
            return false;  
        }  
    }  

    /** 
    * 将数据放入set缓存 
    * @param key 键 
    * @param values 值 可以是多个 
    * @return 成功个数 
    */  
    public long sSet(String key, Object...values) {  
        try {  
            return redisTemplate.opsForSet().add(key, values);  
        } catch (Exception e) {  
            e.printStackTrace();  
            return 0;  
        }  
    }  

    /** 
    * 将set数据放入缓存 
    * @param key 键 
    * @param time 时间(秒) 
    * @param values 值 可以是多个 
    * @return 成功个数 
    */  
    public long sSetAndTime(String key,long time,Object...values) {  
        try {  
            Long count = redisTemplate.opsForSet().add(key, values);  
            if(time&gt;0) expire(key, time);  
            return count;  
        } catch (Exception e) {  
            e.printStackTrace();  
            return 0;  
        }  
    }  

    /** 
    * 获取set缓存的长度 
    * @param key 键 
    * @return 
    */  
    public long sGetSetSize(String key){  
        try {  
            return redisTemplate.opsForSet().size(key);  
        } catch (Exception e) {  
            e.printStackTrace();  
            return 0;  
        }  
    }  

    /** 
    * 移除值为value的 
    * @param key 键 
    * @param values 值 可以是多个 
    * @return 移除的个数 
    */  
    public long setRemove(String key, Object ...values) {  
        try {  
            Long count = redisTemplate.opsForSet().remove(key, values);  
            return count;  
        } catch (Exception e) {  
            e.printStackTrace();  
            return 0;  
        }  
    }  
    //===============================list=================================  

    /** 
    * 获取list缓存的内容 
    * @param key 键 
    * @param start 开始 
    * @param end 结束  0 到 -1代表所有值 
    * @return 
    */  
    public List&lt;Object&gt; lGet(String key,long start, long end){  
        try {  
            return redisTemplate.opsForList().range(key, start, end);  
        } catch (Exception e) {  
            e.printStackTrace();  
            return null;  
        }  
    }  

    /** 
    * 获取list缓存的长度 
    * @param key 键 
    * @return 
    */  
    public long lGetListSize(String key){  
        try {  
            return redisTemplate.opsForList().size(key);  
        } catch (Exception e) {  
            e.printStackTrace();  
            return 0;  
        }  
    }  

    /** 
    * 通过索引 获取list中的值 
    * @param key 键 
    * @param index 索引  index&gt;=0时， 0 表头，1 第二个元素，依次类推；index&lt;0时，-1，表尾，-2倒数第二个元素，依次类推 
    * @return 
    */  
    public Object lGetIndex(String key,long index){  
        try {  
            return redisTemplate.opsForList().index(key, index);  
        } catch (Exception e) {  
            e.printStackTrace();  
            return null;  
        }  
    }  

    /** 
    * 将list放入缓存 
    * @param key 键 
    * @param value 值 
    * @param time 时间(秒) 
    * @return 
    */  
    public boolean lSet(String key, Object value) {  
        try {  
            redisTemplate.opsForList().rightPush(key, value);  
            return true;  
        } catch (Exception e) {  
            e.printStackTrace();  
            return false;  
        }  
    }  

    /** 
    * 将list放入缓存 
    * @param key 键 
    * @param value 值 
    * @param time 时间(秒) 
    * @return 
    */  
    public boolean lSet(String key, Object value, long time) {  
        try {  
            redisTemplate.opsForList().rightPush(key, value);  
            if (time &gt; 0) expire(key, time);  
            return true;  
        } catch (Exception e) {  
            e.printStackTrace();  
            return false;  
        }  
    }  

    /** 
    * 将list放入缓存 
    * @param key 键 
    * @param value 值 
    * @param time 时间(秒) 
    * @return 
    */  
    public boolean lSet(String key, List&lt;Object&gt; value) {  
        try {  
            redisTemplate.opsForList().rightPushAll(key, value);  
            return true;  
        } catch (Exception e) {  
            e.printStackTrace();  
            return false;  
        }  
    }  

    /** 
    * 将list放入缓存 
    * @param key 键 
    * @param value 值 
    * @param time 时间(秒) 
    * @return 
    */  
    public boolean lSet(String key, List&lt;Object&gt; value, long time) {  
        try {  
            redisTemplate.opsForList().rightPushAll(key, value);  
            if (time &gt; 0) expire(key, time);  
            return true;  
        } catch (Exception e) {  
            e.printStackTrace();  
            return false;  
        }  
    }  

    /** 
    * 根据索引修改list中的某条数据 
    * @param key 键 
    * @param index 索引 
    * @param value 值 
    * @return 
    */  
    public boolean lUpdateIndex(String key, long index,Object value) {  
        try {  
            redisTemplate.opsForList().set(key, index, value);  
            return true;  
        } catch (Exception e) {  
            e.printStackTrace();  
            return false;  
        }  
    }   

    /** 
    * 移除N个值为value  
    * @param key 键 
    * @param count 移除多少个 
    * @param value 值 
    * @return 移除的个数 
    */  
    public long lRemove(String key,long count,Object value) {  
        try {  
            Long remove = redisTemplate.opsForList().remove(key, count, value);  
            return remove;  
        } catch (Exception e) {  
            e.printStackTrace();  
            return 0;  
        }  
    }  
}
</code></pre><h2 id="单机模式整合redis"><a href="#单机模式整合redis" class="headerlink" title="单机模式整合redis"></a>单机模式整合redis</h2><p>如果我们只需要整合redis的单机版，只要在redis.conf中进行如下配置</p>
<pre><code>@Configuration
@PropertySource(&quot;classpath:config/redis.properties&quot;)
public class RedisConfig {

    @Value(&quot;${redis.maxIdle}&quot;)
    private Integer maxIdle;

    @Value(&quot;${redis.maxTotal}&quot;)
    private Integer maxTotal;

    @Value(&quot;${redis.maxWaitMillis}&quot;)
    private Integer maxWaitMillis;

    @Value(&quot;${redis.minEvictableIdleTimeMillis}&quot;)
    private Integer minEvictableIdleTimeMillis;

    @Value(&quot;${redis.numTestsPerEvictionRun}&quot;)
    private Integer numTestsPerEvictionRun;

    @Value(&quot;${redis.timeBetweenEvictionRunsMillis}&quot;)
    private long timeBetweenEvictionRunsMillis;

    @Value(&quot;${redis.testOnBorrow}&quot;)
    private boolean testOnBorrow;

    @Value(&quot;${redis.testWhileIdle}&quot;)
    private boolean testWhileIdle;


    @Value(&quot;${spring.redis.cluster.nodes}&quot;)
    private String clusterNodes; 

    @Value(&quot;${spring.redis.cluster.max-redirects}&quot;)
    private Integer mmaxRedirectsac;

    /**
    * JedisPoolConfig 连接池
    * @return
    */
    @Bean
    public JedisPoolConfig jedisPoolConfig() {
        JedisPoolConfig jedisPoolConfig = new JedisPoolConfig();
        // 最大空闲数
        jedisPoolConfig.setMaxIdle(maxIdle);
        // 连接池的最大数据库连接数
        jedisPoolConfig.setMaxTotal(maxTotal);
        // 最大建立连接等待时间
        jedisPoolConfig.setMaxWaitMillis(maxWaitMillis);
        // 逐出连接的最小空闲时间 默认1800000毫秒(30分钟)
        jedisPoolConfig.setMinEvictableIdleTimeMillis(minEvictableIdleTimeMillis);
        // 每次逐出检查时 逐出的最大数目 如果为负数就是 : 1/abs(n), 默认3
        jedisPoolConfig.setNumTestsPerEvictionRun(numTestsPerEvictionRun);
        // 逐出扫描的时间间隔(毫秒) 如果为负数,则不运行逐出线程, 默认-1
        jedisPoolConfig.setTimeBetweenEvictionRunsMillis(timeBetweenEvictionRunsMillis);
        // 是否在从池中取出连接前进行检验,如果检验失败,则从池中去除连接并尝试取出另一个
        jedisPoolConfig.setTestOnBorrow(testOnBorrow);
        // 在空闲时检查有效性, 默认false
        jedisPoolConfig.setTestWhileIdle(testWhileIdle);
        return jedisPoolConfig;
    }
    /**
    * 单机版配置
    * @Title: JedisConnectionFactory 
    * @param @param jedisPoolConfig
    * @param @return
    * @return JedisConnectionFactory
    * @autor lpl
    * @date 2018年2月24日
    * @throws
    */
    @Bean
    public JedisConnectionFactory JedisConnectionFactory(JedisPoolConfig jedisPoolConfig){
        JedisConnectionFactory JedisConnectionFactory = new JedisConnectionFactory(jedisPoolConfig);
        //连接池  
        JedisConnectionFactory.setPoolConfig(jedisPoolConfig);  
        //IP地址  
        JedisConnectionFactory.setHostName(&quot;192.168.177.128&quot;);  
        //端口号  
        JedisConnectionFactory.setPort(6379);  
        //如果Redis设置有密码  
        //JedisConnectionFactory.setPassword(password);  
        //客户端超时时间单位是毫秒  
        JedisConnectionFactory.setTimeout(5000);  
        return JedisConnectionFactory; 
    }

    /**
    * 实例化 RedisTemplate 对象
    *
    * @return
    */
    @Bean
    public RedisTemplate&lt;String, Object&gt; functionDomainRedisTemplate(RedisConnectionFactory redisConnectionFactory) {
        RedisTemplate&lt;String, Object&gt; redisTemplate = new RedisTemplate&lt;&gt;();
        initDomainRedisTemplate(redisTemplate, redisConnectionFactory);
        return redisTemplate;
    }
    /**
    * 设置数据存入 redis 的序列化方式,并开启事务
    * 
    * @param redisTemplate
    * @param factory
    */
    private void initDomainRedisTemplate(RedisTemplate&lt;String, Object&gt; redisTemplate, RedisConnectionFactory factory) {
        //如果不配置Serializer，那么存储的时候缺省使用String，如果用User类型存储，那么会提示错误User can&apos;t cast to String！  
        redisTemplate.setKeySerializer(new StringRedisSerializer());
        redisTemplate.setHashKeySerializer(new StringRedisSerializer());
        redisTemplate.setHashValueSerializer(new GenericJackson2JsonRedisSerializer());
        redisTemplate.setValueSerializer(new GenericJackson2JsonRedisSerializer());
        // 开启事务
        redisTemplate.setEnableTransactionSupport(true);
        redisTemplate.setConnectionFactory(factory);
    }
    /**
    * 注入封装RedisTemplate
    * @Title: redisUtil 
    * @return RedisUtil
    * @autor lpl
    * @date 2017年12月21日
    * @throws
    */
    @Bean(name = &quot;redisUtil&quot;)
    public RedisUtil redisUtil(RedisTemplate&lt;String, Object&gt; redisTemplate) {
        RedisUtil redisUtil = new RedisUtil();
        redisUtil.setRedisTemplate(redisTemplate);
        return redisUtil;
    }
</code></pre><h2 id="集群模式"><a href="#集群模式" class="headerlink" title="集群模式"></a>集群模式</h2><p>如果我们的redis服务是cluster模式，那么就使用下方的配置。</p>
<pre><code>@Configuration
@PropertySource(&quot;classpath:config/redis.properties&quot;)
public class RedisConfig {

    @Value(&quot;${redis.maxIdle}&quot;)
    private Integer maxIdle;

    @Value(&quot;${redis.maxTotal}&quot;)
    private Integer maxTotal;

    @Value(&quot;${redis.maxWaitMillis}&quot;)
    private Integer maxWaitMillis;

    @Value(&quot;${redis.minEvictableIdleTimeMillis}&quot;)
    private Integer minEvictableIdleTimeMillis;

    @Value(&quot;${redis.numTestsPerEvictionRun}&quot;)
    private Integer numTestsPerEvictionRun;

    @Value(&quot;${redis.timeBetweenEvictionRunsMillis}&quot;)
    private long timeBetweenEvictionRunsMillis;

    @Value(&quot;${redis.testOnBorrow}&quot;)
    private boolean testOnBorrow;

    @Value(&quot;${redis.testWhileIdle}&quot;)
    private boolean testWhileIdle;


    @Value(&quot;${spring.redis.cluster.nodes}&quot;)
    private String clusterNodes; 

    @Value(&quot;${spring.redis.cluster.max-redirects}&quot;)
    private Integer mmaxRedirectsac;

    /**
    * JedisPoolConfig 连接池
    * @return
    */
    @Bean
    public JedisPoolConfig jedisPoolConfig() {
        JedisPoolConfig jedisPoolConfig = new JedisPoolConfig();
        // 最大空闲数
        jedisPoolConfig.setMaxIdle(maxIdle);
        // 连接池的最大数据库连接数
        jedisPoolConfig.setMaxTotal(maxTotal);
        // 最大建立连接等待时间
        jedisPoolConfig.setMaxWaitMillis(maxWaitMillis);
        // 逐出连接的最小空闲时间 默认1800000毫秒(30分钟)
        jedisPoolConfig.setMinEvictableIdleTimeMillis(minEvictableIdleTimeMillis);
        // 每次逐出检查时 逐出的最大数目 如果为负数就是 : 1/abs(n), 默认3
        jedisPoolConfig.setNumTestsPerEvictionRun(numTestsPerEvictionRun);
        // 逐出扫描的时间间隔(毫秒) 如果为负数,则不运行逐出线程, 默认-1
        jedisPoolConfig.setTimeBetweenEvictionRunsMillis(timeBetweenEvictionRunsMillis);
        // 是否在从池中取出连接前进行检验,如果检验失败,则从池中去除连接并尝试取出另一个
        jedisPoolConfig.setTestOnBorrow(testOnBorrow);
        // 在空闲时检查有效性, 默认false
        jedisPoolConfig.setTestWhileIdle(testWhileIdle);
        return jedisPoolConfig;
    }
    /**
    * Redis集群的配置
    * @return RedisClusterConfiguration
    * @autor lpl
    * @date 2017年12月22日
    * @throws
    */
    @Bean
    public RedisClusterConfiguration redisClusterConfiguration(){
        RedisClusterConfiguration redisClusterConfiguration = new RedisClusterConfiguration();
        //Set&lt;RedisNode&gt; clusterNodes
        String[] serverArray = clusterNodes.split(&quot;,&quot;);

        Set&lt;RedisNode&gt; nodes = new HashSet&lt;RedisNode&gt;();

        for(String ipPort:serverArray){
            String[] ipAndPort = ipPort.split(&quot;:&quot;);
            nodes.add(new RedisNode(ipAndPort[0].trim(),Integer.valueOf(ipAndPort[1])));
        }

        redisClusterConfiguration.setClusterNodes(nodes);
        redisClusterConfiguration.setMaxRedirects(mmaxRedirectsac);

        return redisClusterConfiguration;
    }
    /**
    * 配置工厂
    * @Title: JedisConnectionFactory 
    * @param @param jedisPoolConfig
    * @param @return
    * @return JedisConnectionFactory
    * @autor lpl
    * @date 2017年12月22日
    * @throws
    */
    @Bean
    public JedisConnectionFactory JedisConnectionFactory(JedisPoolConfig jedisPoolConfig,RedisClusterConfiguration redisClusterConfiguration){
        JedisConnectionFactory JedisConnectionFactory = new JedisConnectionFactory(redisClusterConfiguration,jedisPoolConfig);

        return JedisConnectionFactory; 
    }

    /**
    * 实例化 RedisTemplate 对象
    *
    * @return
    */
    @Bean
    public RedisTemplate&lt;String, Object&gt; functionDomainRedisTemplate(RedisConnectionFactory redisConnectionFactory) {
        RedisTemplate&lt;String, Object&gt; redisTemplate = new RedisTemplate&lt;&gt;();
        initDomainRedisTemplate(redisTemplate, redisConnectionFactory);
        return redisTemplate;
    }
    /**
    * 设置数据存入 redis 的序列化方式,并开启事务
    * 
    * @param redisTemplate
    * @param factory
    */
    private void initDomainRedisTemplate(RedisTemplate&lt;String, Object&gt; redisTemplate, RedisConnectionFactory factory) {
        //如果不配置Serializer，那么存储的时候缺省使用String，如果用User类型存储，那么会提示错误User can&apos;t cast to String！  
        redisTemplate.setKeySerializer(new StringRedisSerializer());
        redisTemplate.setHashKeySerializer(new StringRedisSerializer());
        redisTemplate.setHashValueSerializer(new GenericJackson2JsonRedisSerializer());
        redisTemplate.setValueSerializer(new GenericJackson2JsonRedisSerializer());
        // 开启事务
        redisTemplate.setEnableTransactionSupport(true);
        redisTemplate.setConnectionFactory(factory);
    }
    /**
    * 注入封装RedisTemplate
    * @Title: redisUtil 
    * @return RedisUtil
    * @autor lpl
    * @date 2017年12月21日
    * @throws
    */
    @Bean(name = &quot;redisUtil&quot;)
    public RedisUtil redisUtil(RedisTemplate&lt;String, Object&gt; redisTemplate) {
        RedisUtil redisUtil = new RedisUtil();
        redisUtil.setRedisTemplate(redisTemplate);
        return redisUtil;
    }
</code></pre><h2 id="哨兵模式整合"><a href="#哨兵模式整合" class="headerlink" title="哨兵模式整合"></a>哨兵模式整合</h2><p>线上为了高可用，一般会使用哨兵模式，该模式的配置如下。</p>
<pre><code>@Configuration
@PropertySource(&quot;classpath:config/redis.properties&quot;)
public class RedisConfig {

    @Value(&quot;${redis.maxIdle}&quot;)
    private Integer maxIdle;

    @Value(&quot;${redis.maxTotal}&quot;)
    private Integer maxTotal;

    @Value(&quot;${redis.maxWaitMillis}&quot;)
    private Integer maxWaitMillis;

    @Value(&quot;${redis.minEvictableIdleTimeMillis}&quot;)
    private Integer minEvictableIdleTimeMillis;

    @Value(&quot;${redis.numTestsPerEvictionRun}&quot;)
    private Integer numTestsPerEvictionRun;

    @Value(&quot;${redis.timeBetweenEvictionRunsMillis}&quot;)
    private long timeBetweenEvictionRunsMillis;

    @Value(&quot;${redis.testOnBorrow}&quot;)
    private boolean testOnBorrow;

    @Value(&quot;${redis.testWhileIdle}&quot;)
    private boolean testWhileIdle;


    @Value(&quot;${spring.redis.cluster.nodes}&quot;)
    private String clusterNodes; 

    @Value(&quot;${spring.redis.cluster.max-redirects}&quot;)
    private Integer mmaxRedirectsac;

    /**
    * JedisPoolConfig 连接池
    * @return
    */
    @Bean
    public JedisPoolConfig jedisPoolConfig() {
        JedisPoolConfig jedisPoolConfig = new JedisPoolConfig();
        // 最大空闲数
        jedisPoolConfig.setMaxIdle(maxIdle);
        // 连接池的最大数据库连接数
        jedisPoolConfig.setMaxTotal(maxTotal);
        // 最大建立连接等待时间
        jedisPoolConfig.setMaxWaitMillis(maxWaitMillis);
        // 逐出连接的最小空闲时间 默认1800000毫秒(30分钟)
        jedisPoolConfig.setMinEvictableIdleTimeMillis(minEvictableIdleTimeMillis);
        // 每次逐出检查时 逐出的最大数目 如果为负数就是 : 1/abs(n), 默认3
        jedisPoolConfig.setNumTestsPerEvictionRun(numTestsPerEvictionRun);
        // 逐出扫描的时间间隔(毫秒) 如果为负数,则不运行逐出线程, 默认-1
        jedisPoolConfig.setTimeBetweenEvictionRunsMillis(timeBetweenEvictionRunsMillis);
        // 是否在从池中取出连接前进行检验,如果检验失败,则从池中去除连接并尝试取出另一个
        jedisPoolConfig.setTestOnBorrow(testOnBorrow);
        // 在空闲时检查有效性, 默认false
        jedisPoolConfig.setTestWhileIdle(testWhileIdle);
        return jedisPoolConfig;
    }
/**
    * 配置redis的哨兵
    * @return RedisSentinelConfiguration
    * @autor lpl
    * @date 2017年12月21日
    * @throws
    */
    @Bean
    public RedisSentinelConfiguration sentinelConfiguration(){
        RedisSentinelConfiguration redisSentinelConfiguration = new RedisSentinelConfiguration();
        //配置matser的名称
        RedisNode redisNode = new RedisNode(hostName, port);
        redisNode.setName(&quot;mymaster&quot;);
        redisSentinelConfiguration.master(redisNode);
        //配置redis的哨兵sentinel
        RedisNode senRedisNode = new RedisNode(senHost1,senPort1);
        Set&lt;RedisNode&gt; redisNodeSet = new HashSet&lt;&gt;();
        redisNodeSet.add(senRedisNode);
        redisSentinelConfiguration.setSentinels(redisNodeSet);
        return redisSentinelConfiguration;
    }
    /**
    * 配置工厂
    * @param jedisPoolConfig
    * @return
    */
    @Bean
    public JedisConnectionFactory jedisConnectionFactory(JedisPoolConfig jedisPoolConfig,RedisSentinelConfiguration sentinelConfig) {   
        JedisConnectionFactory jedisConnectionFactory = new JedisConnectionFactory(sentinelConfig,jedisPoolConfig);
        return jedisConnectionFactory;
    }
/**
    * 实例化 RedisTemplate 对象
    *
    * @return
    */
    @Bean
    public RedisTemplate&lt;String, Object&gt; functionDomainRedisTemplate(RedisConnectionFactory redisConnectionFactory) {
        RedisTemplate&lt;String, Object&gt; redisTemplate = new RedisTemplate&lt;&gt;();
        initDomainRedisTemplate(redisTemplate, redisConnectionFactory);
        return redisTemplate;
    }
    /**
    * 设置数据存入 redis 的序列化方式,并开启事务
    * 
    * @param redisTemplate
    * @param factory
    */
    private void initDomainRedisTemplate(RedisTemplate&lt;String, Object&gt; redisTemplate, RedisConnectionFactory factory) {
        //如果不配置Serializer，那么存储的时候缺省使用String，如果用User类型存储，那么会提示错误User can&apos;t cast to String！  
        redisTemplate.setKeySerializer(new StringRedisSerializer());
        redisTemplate.setHashKeySerializer(new StringRedisSerializer());
        redisTemplate.setHashValueSerializer(new GenericJackson2JsonRedisSerializer());
        redisTemplate.setValueSerializer(new GenericJackson2JsonRedisSerializer());
        // 开启事务
        redisTemplate.setEnableTransactionSupport(true);
        redisTemplate.setConnectionFactory(factory);
    }
</code></pre><h2 id="使用RedisUtil"><a href="#使用RedisUtil" class="headerlink" title="使用RedisUtil"></a>使用RedisUtil</h2><p>封装完毕，如何使用呢？我们需要在配置类中声明一个RedisUtil的Bean，代码如下。<br>有了该配置我们就可以在我们的业务代码中使用@Autowired注入我们的redis操作工具类实例。</p>
<pre><code>/**
* @Title: redisUtil 
* @return RedisUtil
* @autor lpl
* @date 2017年12月21日
* @throws
 */
@Bean(name = &quot;redisUtil&quot;)
public RedisUtil redisUtil(RedisTemplate&lt;String, Object&gt; redisTemplate) {
    RedisUtil redisUtil = new RedisUtil();
    redisUtil.setRedisTemplate(redisTemplate);
    return redisUtil;
}
</code></pre>  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/spring-boot/">spring-boot</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/spring-boot/">spring-boot</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://wuwenliang.net/2018/07/23/springboot整合redis小结/" data-title="springboot整合redis小结 | 朝·闻·道" data-tsina="null" class="share clearfix">
	  </div>
	
	</div>


</footer>

   
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2018/07/23/springboot中使用RestTemplate调用web服务小结/" title="springboot中使用RestTemplate调用web服务小结">
  <strong>上一篇：</strong><br/>
  <span>
  springboot中使用RestTemplate调用web服务小结</span>
</a>
</div>


<div class="next">
<a href="/2018/07/22/JDK源码解析-3-Thread/"  title="JDK源码解析[3]-Thread">
 <strong>下一篇：</strong><br/> 
 <span>JDK源码解析[3]-Thread
</span>
</a>
</div>

</nav>

	
<section id="comments" class="comment">
	<div class="ds-thread" data-thread-key="2018/07/23/springboot整合redis小结/" data-title="springboot整合redis小结" data-url="http://wuwenliang.net/2018/07/23/springboot整合redis小结/"></div>
</section>




</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#补充-SpringBoot2-x整合Redis"><span class="toc-number">1.</span> <span class="toc-text">补充-SpringBoot2.x整合Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#引入maven依赖"><span class="toc-number">1.1.</span> <span class="toc-text">引入maven依赖</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#配置application-properties"><span class="toc-number">1.2.</span> <span class="toc-text">配置application.properties</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#编写测试用例"><span class="toc-number">1.3.</span> <span class="toc-text">编写测试用例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SpringBoot1-x整合方式"><span class="toc-number">2.</span> <span class="toc-text">SpringBoot1.x整合方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#maven依赖"><span class="toc-number">3.</span> <span class="toc-text">maven依赖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#配置文件"><span class="toc-number">4.</span> <span class="toc-text">配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#封装RedisUtil工具类"><span class="toc-number">5.</span> <span class="toc-text">封装RedisUtil工具类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#单机模式整合redis"><span class="toc-number">6.</span> <span class="toc-text">单机模式整合redis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#集群模式"><span class="toc-number">7.</span> <span class="toc-text">集群模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#哨兵模式整合"><span class="toc-number">8.</span> <span class="toc-text">哨兵模式整合</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用RedisUtil"><span class="toc-number">9.</span> <span class="toc-text">使用RedisUtil</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/Dubbo/" title="Dubbo">Dubbo<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/ELK-Stack/" title="ELK-Stack">ELK-Stack<sup>7</sup></a></li>
		  
		
		  
			<li><a href="/categories/HTTPS/" title="HTTPS">HTTPS<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Hexo/" title="Hexo">Hexo<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/JDK-concurrent/" title="JDK-concurrent">JDK-concurrent<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/JDK源码解析/" title="JDK源码解析">JDK源码解析<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/Java/" title="Java">Java<sup>22</sup></a></li>
		  
		
		  
			<li><a href="/categories/KindEditor/" title="KindEditor">KindEditor<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Linux/" title="Linux">Linux<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/Redis/" title="Redis">Redis<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/SSO/" title="SSO">SSO<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Sharding-JDBC/" title="Sharding-JDBC">Sharding-JDBC<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/SpringCloud/" title="SpringCloud">SpringCloud<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Tomcat/" title="Tomcat">Tomcat<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/auth/" title="auth">auth<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/docker/" title="docker">docker<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/hexo/" title="hexo">hexo<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/kubernates/" title="kubernates">kubernates<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/maven/" title="maven">maven<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/mybatis/" title="mybatis">mybatis<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/mysql/" title="mysql">mysql<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/categories/nginx/" title="nginx">nginx<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/nginx-负载均衡/" title="nginx, 负载均衡">nginx, 负载均衡<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/spring-boot/" title="spring-boot">spring-boot<sup>25</sup></a></li>
		  
		
		  
			<li><a href="/categories/springboot/" title="springboot">springboot<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/web/" title="web">web<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/与你同行/" title="与你同行">与你同行<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/专题-分布式/" title="专题-分布式">专题-分布式<sup>13</sup></a></li>
		  
		
		  
			<li><a href="/categories/代理模式-工作总结-入职感受/" title="代理模式,工作总结,入职感受">代理模式,工作总结,入职感受<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/分布式-Dubbo/" title="分布式 Dubbo">分布式 Dubbo<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/categories/单例模式/" title="单例模式">单例模式<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/年度总结/" title="年度总结">年度总结<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/数据库/" title="数据库">数据库<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/架构/" title="架构">架构<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/汇总盘点推荐/" title="汇总盘点推荐">汇总盘点推荐<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/爬虫/" title="爬虫">爬虫<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/电话面试/" title="电话面试">电话面试<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/自己写分布式组件系列/" title="自己写分布式组件系列">自己写分布式组件系列<sup>9</sup></a></li>
		  
		
		  
			<li><a href="/categories/跟我学RocketMQ/" title="跟我学RocketMQ">跟我学RocketMQ<sup>7</sup></a></li>
		  
		
		  
			<li><a href="/categories/随笔/" title="随笔">随笔<sup>5</sup></a></li>
		  
		
		</ul>
</div>


  
  <div class="tagcloudlist">
    <p class="asidetitle">标签云</p>
    <div class="tagcloudlist clearfix">
       <a href="/tags/Dubbo/" style="font-size: 13.33px;">Dubbo</a> <a href="/tags/ELK-Stack/" style="font-size: 15.56px;">ELK-Stack</a> <a href="/tags/HTTPS/" style="font-size: 10px;">HTTPS</a> <a href="/tags/Hexo/" style="font-size: 10px;">Hexo</a> <a href="/tags/JDK-concurrent/" style="font-size: 12.22px;">JDK-concurrent</a> <a href="/tags/JDK源码解析/" style="font-size: 13.33px;">JDK源码解析</a> <a href="/tags/Java/" style="font-size: 18.89px;">Java</a> <a href="/tags/KindEditor/" style="font-size: 10px;">KindEditor</a> <a href="/tags/Linux/" style="font-size: 11.11px;">Linux</a> <a href="/tags/Redis/" style="font-size: 10px;">Redis</a> <a href="/tags/SSO-单点登录/" style="font-size: 10px;">SSO,单点登录</a> <a href="/tags/Sharding-JDBC/" style="font-size: 13.33px;">Sharding-JDBC</a> <a href="/tags/SpringCloud/" style="font-size: 10px;">SpringCloud</a> <a href="/tags/Tomcat/" style="font-size: 11.11px;">Tomcat</a> <a href="/tags/auth/" style="font-size: 11.11px;">auth</a> <a href="/tags/docker/" style="font-size: 12.22px;">docker</a> <a href="/tags/hexo/" style="font-size: 11.11px;">hexo</a> <a href="/tags/kubernates/" style="font-size: 10px;">kubernates</a> <a href="/tags/maven/" style="font-size: 12.22px;">maven</a> <a href="/tags/mybatis/" style="font-size: 11.11px;">mybatis</a> <a href="/tags/mysql/" style="font-size: 14.44px;">mysql</a> <a href="/tags/nginx/" style="font-size: 11.11px;">nginx</a> <a href="/tags/spring-boot/" style="font-size: 20px;">spring-boot</a> <a href="/tags/springboot/" style="font-size: 10px;">springboot</a> <a href="/tags/web/" style="font-size: 13.33px;">web</a> <a href="/tags/与你同行/" style="font-size: 10px;">与你同行</a> <a href="/tags/专题-分布式/" style="font-size: 17.78px;">专题-分布式</a> <a href="/tags/代理模式-工作总结-入职感受/" style="font-size: 10px;">代理模式,工作总结,入职感受</a> <a href="/tags/分布式-Dubbo/" style="font-size: 13.33px;">分布式 Dubbo</a> <a href="/tags/单例模式-懒加载/" style="font-size: 10px;">单例模式, 懒加载</a> <a href="/tags/年度总结/" style="font-size: 12.22px;">年度总结</a> <a href="/tags/我们的爱情/" style="font-size: 10px;">我们的爱情</a> <a href="/tags/数据库/" style="font-size: 10px;">数据库</a> <a href="/tags/汇总盘点推荐/" style="font-size: 10px;">汇总盘点推荐</a> <a href="/tags/爬虫-WebMagic/" style="font-size: 10px;">爬虫,WebMagic</a> <a href="/tags/电话面试/" style="font-size: 10px;">电话面试</a> <a href="/tags/秒杀/" style="font-size: 10px;">秒杀</a> <a href="/tags/自己写分布式组件系列/" style="font-size: 16.67px;">自己写分布式组件系列</a> <a href="/tags/跟我学RocketMQ/" style="font-size: 15.56px;">跟我学RocketMQ</a> <a href="/tags/随笔/" style="font-size: 14.44px;">随笔</a>
    </div>
  </div>


  
<div class="github-card">
<p class="asidetitle">Github 名片</p>
<div class="github-card" data-github="TaXueWWL" data-width="220" data-height="119" data-theme="medium">
<script type="text/javascript" src="//cdn.jsdelivr.net/github-cards/latest/widget.js" ></script>
</div>
  </div>



  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/spring-boot/" title="spring-boot">spring-boot<sup>25</sup></a></li>
			
		
			
				<li><a href="/tags/Java/" title="Java">Java<sup>22</sup></a></li>
			
		
			
				<li><a href="/tags/专题-分布式/" title="专题-分布式">专题-分布式<sup>13</sup></a></li>
			
		
			
				<li><a href="/tags/自己写分布式组件系列/" title="自己写分布式组件系列">自己写分布式组件系列<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/ELK-Stack/" title="ELK-Stack">ELK-Stack<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/跟我学RocketMQ/" title="跟我学RocketMQ">跟我学RocketMQ<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/随笔/" title="随笔">随笔<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/mysql/" title="mysql">mysql<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/Sharding-JDBC/" title="Sharding-JDBC">Sharding-JDBC<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/JDK源码解析/" title="JDK源码解析">JDK源码解析<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/web/" title="web">web<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/Dubbo/" title="Dubbo">Dubbo<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/分布式-Dubbo/" title="分布式 Dubbo">分布式 Dubbo<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/年度总结/" title="年度总结">年度总结<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/maven/" title="maven">maven<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/JDK-concurrent/" title="JDK-concurrent">JDK-concurrent<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/docker/" title="docker">docker<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/Linux/" title="Linux">Linux<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/auth/" title="auth">auth<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/nginx/" title="nginx">nginx<sup>2</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="undefined" target="_blank" title="rss">RSS 订阅</a>
</div>

  <div class="weiboshow">
  <p class="asidetitle">新浪微博</p>
    <iframe width="100%" height="119" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=119&fansRow=2&ptype=1&speed=0&skin=9&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=null&verifier=b3593ceb&dpc=1"></iframe>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p>  <br/>
			惟精惟一，允执厥中 朝闻道，夕死可矣</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		<a href="https://github.com/TaXueWWL" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		
		
		<a href="http://www.zhihu.com/people/TaXueWWL" target="_blank" class="icon-zhihu" title="知乎"></a>
		
		
		
		<a href="mailto:wuwenliangsn@gmail.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2019 
		
		<a href="/about" target="_blank" title="SnoWalker">SnoWalker</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>



<script type="text/javascript">
  var duoshuoQuery = {short_name:"snowalker"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 







<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?e6d1f421bbc9962127a50488f9ed37d1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>

<a href="https://github.com/TaXueWWL" target="_blank"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_left_white_ffffff.png" alt="Fork me on GitHub"></a>